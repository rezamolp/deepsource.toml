# Guardian Telegram Bot - Link Rotation System

## ๐ง ูุดฺฉูุงุช ุฑูุน ุดุฏู

### ูุดฺฉูุงุช ุจุญุฑุงู (Critical Issues)

#### 1. **ROT-NOP** - ฺุฑุฎุด ูููู ฺฉุงุฐุจ
- **ูุดฺฉู:** ูพุงู ููููุช ุจุฏูู ุชุบุฑ ูุงูุน ููฺฉ
- **ุฑุงูโุญู:** ุงุถุงูู ฺฉุฑุฏู ุฑุงุณุชโุขุฒูุง ุจุนุฏ ุงุฒ ูุฑ ฺุฑุฎุด
- **ูุงู:** `services/telethon_manager.py` - ุชุงุจุน `verify_username_change`

#### 2. **CHATID-MISMATCH** - ุดูุงุณู ฺฉุงูุงู ุงุดุชุจุงู
- **ูุดฺฉู:** ุงุณุชูุงุฏู ุงุฒ chat_id ุงุฏูู ุจู ุฌุง id ฺฉุงูุงู
- **ุฑุงูโุญู:** ุญู ุฏูู ฺฉุงูุงู ุงุฒ username/link
- **ูุงู:** `services/telethon_manager.py` - ุชุงุจุน `resolve_channel_entity`

#### 3. **API-CHOICE** - ุงูุชุฎุงุจ API ุงุดุชุจุงู
- **ูุดฺฉู:** ุงุณุชูุงุฏู ุงุฒ Bot API ุจู ุฌุง Telethon
- **ุฑุงูโุญู:** ุงุณุชูุงุฏู ุงูุญุตุงุฑ ุงุฒ Telethon ุจุฑุง ุชุบุฑ ููฺฉ
- **ูุงู:** `services/telethon_manager.py` - ุชุงุจุน `change_channel_link`

### ูุดฺฉูุงุช ููู (Major Issues)

#### 4. **PERM-MISSING** - ุนุฏู ุจุฑุฑุณ ูุฌูุฒูุง
- **ูุดฺฉู:** ุนุฏู ุจุฑุฑุณ ูุฌูุฒ "ุชุบุฑ ุงุทูุงุนุงุช"
- **ุฑุงูโุญู:** ุจุฑุฑุณ ฺฉุงูู ูุฌูุฒูุง ูุจู ุงุฒ ุงูุฏุงู
- **ูุงู:** `services/telethon_manager.py` - ุชุงุจุน `check_channel_permissions`

#### 5. **USERNAME-OCC** - ุนุฏู ูุฏุฑุช ูุงูโูุง ุงุดุบุงู ุดุฏู
- **ูุดฺฉู:** ุดฺฉุณุช ุฎุงููุด ุฏุฑ ุตูุฑุช ุงุดุบุงู ุจูุฏู ูุงู
- **ุฑุงูโุญู:** ุญููู ูพุณููุฏูุง ุจุง ูุฏุฑุช ุฎุทุง
- **ูุงู:** `services/channel.py` - ุชุงุจุน `_attempt_username_rotation`

#### 6. **AWAIT-MISS** - ุนุฏู ุงูุชุธุงุฑ ุจุฑุง ุนููุงุช async
- **ูุดฺฉู:** ุนุฏู await ุจุฑุง callูุง Telethon
- **ุฑุงูโุญู:** ุงุทููุงู ุงุฒ await ุชูุงู ุนููุงุช async
- **ูุงู:** `services/telethon_manager.py`

#### 7. **STATUS-FALSEPOS** - ูุถุนุช ฺฉุงุฐุจ
- **ูุดฺฉู:** ฺฏุฒุงุฑุด ููููุช ุจุฑ ุงุณุงุณ ุชูููุชุฑ ุฏุงุฎู
- **ุฑุงูโุญู:** ุฎูุงูุฏู ูุถุนุช ูุงูุน ุงุฒ ุชูฺฏุฑุงู
- **ูุงู:** `handlers/callbacks.py` - ุชุงุจุน `_handle_status_request`

### ูุดฺฉูุงุช ูุดุงูุฏูโูพุฐุฑ (Observability Issues)

#### 8. **LOG-GAPS** - ูุงฺฏโูุง ูุงูุต
- **ูุดฺฉู:** ุนุฏู ุซุจุช reason ุฏูู ุดฺฉุณุชโูุง
- **ุฑุงูโุญู:** ูุงฺฏ ฺฉุงูู ุจุง trace_id ู reason
- **ูุงู:** ุชูุงู ุณุฑูุณโูุง

## ๐ ูฺฺฏโูุง ุฌุฏุฏ

### 1. **ูุงุชุฑุณ ุณูุงูุช ฺฉุงูุงู**
- ุจุฑุฑุณ ฺฉุงูู ูุฌูุฒูุง
- ููุงุด ูุถุนุช Telethon
- ุชุดุฎุต ูุดฺฉูุงุช ุงุญุชูุงู

### 2. **ุฑุงุณุชโุขุฒูุง ุฎูุฏฺฉุงุฑ**
- ุชุฃุฏ ุชุบุฑ ููฺฉ ุงุฒ ุชูฺฏุฑุงู
- ุฌููฺฏุฑ ุงุฒ ููููุช ฺฉุงุฐุจ
- ฺฏุฒุงุฑุด ุฏูู ูุถุนุช

### 3. **ุขูุงุฑ ุชูุตู ฺุฑุฎุด**
- ุดูุงุฑุด ููููุชโูุง ู ุดฺฉุณุชโูุง
- ูุญุงุณุจู ูุฑุฎ ููููุช
- ุฑุฏุงุจ ุขุฎุฑู ฺุฑุฎุด

### 4. **ุณุณุชู ุงุนูุงู ูพุดุฑูุชู**
- ุงุนูุงูโูุง ุชูุตู
- retry mechanism
- ูพุงูโูุง ุฑุงูููุง

### 5. **ูุฏุฑุช ุฎุทุง ุฌุงูุน**
- ุฏุณุชูโุจูุฏ ุฎุทุงูุง
- ุฑุงูููุง ุจุฑุง ุฑูุน ูุดฺฉู
- ูุงฺฏโูุง ุณุงุฎุชุงุฑุงูุชู

## ๐ ูุญูู ุงุณุชูุงุฏู

### 1. ุชูุธู ุงููู
```bash
# ูุตุจ ูุงุจุณุชฺฏโูุง
pip install -r requirements.txt

# ุชูุธู ูุชุบุฑูุง ูุญุท
cp .env.example .env
# ูุฑุงุด ูุงู .env
```

### 2. ุชูุธู Telethon
1. ุฏฺฉูู "ุงูุฒูุฏู ุงฺฉุงูุช Telethon" ุฑุง ุจุฒูุฏ
2. ุดูุงุฑู ุชููู ุฑุง ูุงุฑุฏ ฺฉูุฏ
3. ฺฉุฏ ุชุฃุฏ ุฑุง ูุงุฑุฏ ฺฉูุฏ

### 3. ุชูุธู ฺฉุงูุงู
1. ุฏฺฉูู "ุซุจุช ฺฉุงูุงู" ุฑุง ุจุฒูุฏ
2. ูุงู ฺฉุงุฑุจุฑ ฺฉุงูุงู ุฑุง ูุงุฑุฏ ฺฉูุฏ
3. ูุงุชุฑุณ ุณูุงูุช ุฑุง ุจุฑุฑุณ ฺฉูุฏ

### 4. ฺุฑุฎุด ููฺฉ
1. ุฏฺฉูู "ุชุบุฑ ููฺฉ ุฏุณุช" ุฑุง ุจุฒูุฏ
2. ูุงู ูพุงู ุฑุง ูุงุฑุฏ ฺฉูุฏ
3. ููุชุธุฑ ูุชุฌู ุจุงุดุฏ

## ๐ ูุธุงุฑุช ู ุนุจโุงุจ

### ุฏฺฉููโูุง ุฌุฏุฏ
- **ุจุฑุฑุณ ุณูุงูุช:** ุชุดุฎุต ูุดฺฉูุงุช ุณุณุชู
- **ุขูุงุฑ ฺุฑุฎุด:** ูุดุงูุฏู ุนููฺฉุฑุฏ ุณุณุชู
- **ูุถุนุช ุฑุจุงุช:** ุงุทูุงุนุงุช ุฌุงูุน ูุถุนุช

### ูุงฺฏโูุง ุณุงุฎุชุงุฑุงูุชู
```python
logger.info("rotation_success", extra={
    "channel_id": channel_id,
    "new_username": new_username,
    "trace_id": trace_id,
    "verified": True
})
```

### ฺฉุฏูุง ุฎุทุง
- `permission_error`: ูุดฺฉู ูุฌูุฒ
- `username_occupied`: ูุงู ุงุดุบุงู ุดุฏู
- `verification_failed`: ุนุฏู ุชุฃุฏ ุชุบุฑ
- `telethon_error`: ูุดฺฉู ุงุชุตุงู

## ๐ ุงููุช

### ุจุฑุฑุณ ูุฌูุฒูุง
- ุชุฃุฏ ุงุฏูู ุจูุฏู
- ุจุฑุฑุณ ูุฌูุฒ ุชุบุฑ ุงุทูุงุนุงุช
- ุงุนุชุจุงุฑุณูุฌ ุฏุณุชุฑุณ

### ูุฏุฑุช ุฌูุณู
- ุฐุฎุฑู ุงูู session
- ูุฏุฑุช ุฎุทุงูุง ุงุญุฑุงุฒ ููุช
- ูุญุงูุธุช ุงุฒ ุงุทูุงุนุงุช ุญุณุงุณ

## ๐งช ุชุณุช

### ุงุฌุฑุง ุชุณุชโูุง
```bash
# ุงุฌุฑุง ุชูุงู ุชุณุชโูุง
pytest

# ุงุฌุฑุง ุชุณุชโูุง ุฎุงุต
pytest guardian_tests/test_link_rotator.py
```

### ุชุณุชโูุง ุฌุฏุฏ
- ุชุณุช ุฑุงุณุชโุขุฒูุง
- ุชุณุช ูุฏุฑุช ุฎุทุง
- ุชุณุช ูุฌูุฒูุง

## ๐ ุจูุจูุฏ ุนููฺฉุฑุฏ

### ุจูููโุณุงุฒโูุง
- ฺฉุงูุด ุฏุฑุฎูุงุณุชโูุง ุบุฑุถุฑูุฑ
- ูุฏุฑุช ุจูุชุฑ ุฎุทุงูุง
- ุจูุจูุฏ ุชุฌุฑุจู ฺฉุงุฑุจุฑ

### ูุธุงุฑุช
- ุขูุงุฑ ุนููฺฉุฑุฏ
- ุชุดุฎุต ูุดฺฉูุงุช
- ฺฏุฒุงุฑุดโฺฏุฑ

## ๐ ุชุบุฑุงุช ุขูุฏู

### ูฺฺฏโูุง ูพุดููุงุฏ
- ฺุฑุฎุด ุฎูุฏฺฉุงุฑ ุจุฑ ุงุณุงุณ ุฒูุงู
- ูพุดุชุจุงู ุงุฒ ฺูุฏู ฺฉุงูุงู
- API ุจุฑุง ูุฏุฑุช ุฎุงุฑุฌ
- ุฏุงุดุจูุฑุฏ ูุจ

### ุจูุจูุฏูุง ูู
- ฺฉุด ฺฉุฑุฏู ุงุทูุงุนุงุช
- ุจูููโุณุงุฒ ุฏุฑุฎูุงุณุชโูุง
- ูพุดุชุจุงู ุงุฒ Webhook

## ๐ ูพุดุชุจุงู

### ฺฏุฒุงุฑุด ูุดฺฉู
- ุงุณุชูุงุฏู ุงุฒ trace_id
- ุงุฑุงุฆู ูุงฺฏโูุง ูุฑุจูุทู
- ุชูุถุญ ูุฑุงุญู ุชููุฏ ูุดฺฉู

### ุฑุงูููุง
- ุจุฑุฑุณ ูุงุชุฑุณ ุณูุงูุช
- ูุฑูุฑ ุขูุงุฑ ฺุฑุฎุด
- ุชุณุช ูุฌูุฒูุง

---

**ูุณุฎู:** 2.0.0  
**ุชุงุฑุฎ:** 2024  
**ูุถุนุช:** ุชููุฏ ุขูุงุฏู
